# aliyun-muliti-line-regex-tester(amrt)

该程序用于辅助编写阿里云SLS中，多行日志模式的首行正则表达式。

## Quick Start

0. 安装本库`pip install .`（建议使用虚拟环境,如`rye sync`）
1. 准备一份原始的日志输入文本文件
2. 准备一个yaml配置文件，用于为不同格式的日志输出定义正则
3. `python -m amrt {日志文件} {配置文件:examples/driver.yaml}`

```shell

捕获到多行结果：11/130552个,其中有11个已过滤

                                           表达式统计                                           
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━┓
┃ 表达式                                      ┃ 描述                       ┃ 出现次数 ┃ 百分比 ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━┩
│ \d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}\| │ 标准格式                   │ 102878   │ 78.80% │
│ \d{2}-\d{2}-\d{4}:\d{2}:\d{2}:\d{2},\d+     │ 网络请求日志               │ 19785    │ 15.15% │
│ \/camel.+?(jpe*g|png|pdf)                   │ 莫名奇妙的打印oss文件名    │ 3907     │ 2.99%  │
│ .+?, \d+ .+? \d{4} \d{2}:\d{2}:\d{2} GMT    │ 莫名奇妙的打印时间日期     │ 2025     │ 1.55%  │
│ \d{10}                                      │ 莫名其妙的时间戳           │ 1882     │ 1.44%  │
│ image\/                                     │ 莫名奇妙的打印图片类型     │ 71       │ 0.05%  │
│ .{32}_.+?\.(png|jpe*g)                      │ 莫名奇妙的身份证图片文件名 │ 4        │ 0.00%  │
└─────────────────────────────────────────────┴────────────────────────────┴──────────┴────────┘
按照出现频率拼接的首行表达式：

(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}\||\d{2}-\d{2}-\d{4}:\d{2}:\d{2}:\d{2},\d+|\/camel.+?(jpe*g|png|pdf)|.+?, \d+ .+? \d{4} \d{2}:\d{2}:\d{2} GMT|\d{10}|image\/|.{32}_.+?\.(png|jpe*g)).*


All Clear!!🎉
```
